MongoDB 심화 쿼리, 정렬, 인덱스
1. 조건 쿼리 심화
MongoDB 쿼리 연산자를 사용하여 더 복잡한 조건을 조합할 수 있습니다.

JavaScript

// 나이가 20 이상 30 이하인 문서를 찾아라
db.users.find({ age: { $gte: 20, $lte: 30 } });

// name 필드가 "moon" 또는 "go"인 모든 문서를 찾아라
db.users.find({ name: { $in: ["moon", "go"] } });


2. 정렬 (sort())
쿼리 결과를 특정 필드를 기준으로 정렬합니다.

JavaScript

// age 필드를 기준으로 오름차순으로 정렬
db.users.find().sort({ age: 1 });

// age 필드를 기준으로 내림차순으로 정렬
db.users.find().sort({ age: -1 });
1은 오름차순(ASC), -1은 내림차순(DESC)을 의미합니다.

3. 인덱스 (Index)
기본 개념
- 역할: 쿼리(데이터 검색) 속도를 크게 높여줍니다. 인덱스가 없으면 MongoDB는 쿼리를 만족하는 문서를 찾기 위해 컬렉션 전체를 스캔하는데, 이를 컬렉션 스캔이라고 합니다. 이는 데이터가 많을수록 매우 비효율적입니다.

- 작동 원리: 인덱스는 지정된 필드의 데이터를 B-Tree 구조로 정렬하여 저장합니다. 이를 통해 데이터베이스가 전체 문서를 훑지 않고, 인덱스를 따라 빠르게 원하는 위치로 이동할 수 있습니다.

- 기본 인덱스: MongoDB는 모든 컬렉션에 _id 필드에 대한 기본 인덱스를 자동으로 생성합니다. _id는 컬렉션 내에서 고유해야 하므로 이 인덱스는 데이터의 무결성을 보장하는 역할도 합니다.

인덱스 종류 및 생성
MongoDB는 다양한 종류의 인덱스를 제공하며, db.collection.createIndex() 메서드를 사용하여 생성합니다.

단일 필드 인덱스 (Single-Field Index): 특정 필드 하나에 대한 인덱스로, 가장 기본적인 형태입니다.

JavaScript

// age 필드를 기준으로 오름차순 인덱스를 생성한다
db.users.createIndex({ age: 1 });
(1: 오름차순, -1: 내림차순)

복합 인덱스 (Compound Index): 여러 필드를 조합하여 만든 인덱스입니다. 필드들의 순서가 중요합니다.

JavaScript

// country와 name 필드를 기준으로 복합 인덱스를 생성한다
db.users.createIndex({ country: 1, name: 1 });

